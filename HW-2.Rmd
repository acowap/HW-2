---
title: "MATH 216 Homework 2"
author: "Alden Cowap"
output:
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    smooth_scroll: false
---

```{r, echo=FALSE, message=FALSE}
library(tidyverse)
```


```{r, echo=FALSE, message=FALSE, cache=TRUE}
# Do not edit this code block. By setting cache=TRUE, we are saving the output 
# of this block to the cache. That way it only needs to run once.  This is
# especially useful for portions of code that take a long time to run.
profiles <- read_csv(file="profiles.csv")
```



## Admistrative:

Please indicate

* Who you collaborated with: Emily Goins
* Roughly how much time you spent on this HW so far: 2 hours
* The URL of the RPubs published URL [here](http://rpubs.com/acowap/HW2).
* What gave you the most trouble:
* Any comments you have:



## Question 1:

Perform an Exploratory Data Analysis (EDA) on the `profiles` data set,
specifically on the relationship between gender and

* `income`
* `job`
* One more categorical variable of your choice

all keeping in mind in HW-3, you will be fitting a logistic regression to
predict a user's gender based on these variables.

Sex vs. Income
```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.width=8, fig.height=4.5}

profiles2 <- profiles %>% filter(!is.na(job)) %>% filter(income != -1) %>% filter(!is.na(sex))

ggplot(data = profiles2, aes(x = sex, y = income)) +
  geom_boxplot()

profilesincome <- profiles2 %>% group_by(income, sex) %>% tally(sort = TRUE)

ggplot(data = profilesincome, aes(x = n, y = income)) + facet_wrap(~sex) + geom_point()

ggplot(data = profiles2, aes(x = income, fill = sex)) + geom_bar(position = "dodge") 

ggplot(data = profiles2, aes(x = income, fill = sex)) + geom_bar(position = "fill")
```

Based on these graphs, we can see that men have a higher mean income, that it is partially driven by outliers because more men than women report incomes over $250,000. Looking at the percentage male vs. female for each income level doesn't give us much information since there are more men than women in the data set. 


Sex vs. Job
```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.width=8, fig.height=4.5}

ggplot(data = profiles2, aes(x = job, fill = sex)) + geom_bar(position = "fill") + coord_flip()

ggplot(data = profiles2, aes(x = job, fill = sex)) + geom_bar(position = "stack") + coord_flip()

```
Since there are more men than women in the data set, it makes sense that almost all of the job categorys have more than 50% men. The three jobs that come close or exceed 50% female are clerical/administrative, education/academia, and medicine/health. The jobs with the fewest women seem to be construction/craftsmenship, military, and computer/hardware/software. However, since the data set is from San Fransisco where a lot of individuals work in the Tech/computer industry, the percentage in that industry could easily be skewed by pure numbers. 


Sex vs. Diet
```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.width=8, fig.height=4.5}


ggplot(data = profiles2, aes(x = diet, fill = sex)) + geom_bar(position = "fill") + coord_flip()

ggplot(data = profiles2, aes(x = diet, fill = sex)) + geom_bar(position = "stack") + coord_flip()
```

A vast majority of people say that they eat some variation of "anything", though if they do have a dietary restriction they are most likely to be "mostly vegitatian". Dietary habits don't seem to be gendered one way or the other with most options falling around 40% female (which makes sense given that our data set is 40% female). It seems that only men are Kosher and Halal, but that would be a dangerous assumption to pull given that so few members of the data set are Koser or Halal. 

## Question 2:

In the file `HW-2_Shiny_App.Rmd`, build the Shiny App discussed in Lec09 on
Monday 10/3: Using the `movies` data set in the `ggplot2movies` data set, make a
Shiny app that

* Plots budget on the x-axis and rating on the y-axis
* Instead of having a radio button to select the genre of movie (`Action`,
`Animation`, `Comedy`, etc), have a radio button that allows you to toggle
between comedies and non-comedies. This app should be simpler.

